---
title: 'Using tidyr: A Short Demo'
author: "Shiv Sundar"
date: "May 30, 2018"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
library(tidyr)
library(dplyr)
data <- read.csv("../data/sleepData.csv")
data <- data %>%
  drop_na(vore)
data <- data %>%
  mutate("rem_ratio" = sleep_rem/sleep_total) %>%
  select(-sleep_rem, -genus, -order)
worldCountries <- read.csv("../data/worldCountries.csv") %>%
  select(Country, Area..sq..mi.., Arable...., Crops...., Other....) %>%
  gather(key = "Land Type (%)", value = "Measurement", Area..sq..mi.., Arable...., Crops...., Other....)
knitr::opts_chunk$set(echo = TRUE)
```

#Introduction
In this demo, we will take a look at a package called `tidyr` and its most used functions. `tidyr` is a tool used for cleaning up data for ease of use later. 

##Getting our relevant data
Here's what our data looks like currently:

```{r}
head(data)
```

This data, while mostly organized, is not "clean". We can use the `tidyr` package to accomplish this goal.

##separate()
In this data, the `latin_name` column has data that we can split using the `separate()` function. This way, it will be easier to find out how many _genera_ fall into each diet type.
```{r}
data <- data %>%
  separate(order_genus, c("genus", "order"), sep = ", ", remove = TRUE)
head(data)
```

##unite()
Here, we put two columns together by using the `unite()` function. Our data originally looks like this.

```{r}
head(data$vore)
```

The formatting of this data isn't easy to understand. What we can do is create a column of the same  

```{r}
data$suffix = "vore"
data <- data %>%
  unite("diet", vore, suffix, sep = "", remove = TRUE)
head(data)
```

##spread()
Looking at our `worldCountries` data frame, we find that it is extremely long and contains repeated observations

```{r}
filter(worldCountries, Country %in% levels(worldCountries$Country)[1:4])
```

To fix this, we can use the `spread()` function. 

```{r}
worldCountriesWide <- worldCountries %>%
  spread(`Land Type (%)`, Measurement)
head(worldCountriesWide)
```

In the previous example, we saw a way to convert a _long_ data frame to a _wide_ data frame. We can do the exact opposite with the `gather()` function. 
##gather()

```{r}
worldCountriesLong <- worldCountriesWide %>%
  gather("Land Type (%)", "Measurement", -Country)
head(worldCountriesLong)
```

